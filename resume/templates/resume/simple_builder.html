<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Resume Builder - StudyShala</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #f8f9fa; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .resume-container { max-width: 800px; margin: 0 auto; background: #fff; padding: 30px; box-shadow: 0 0 15px rgba(0,0,0,0.1); border-radius: 8px; }
        .profile-img { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 3px solid #0d6efd; margin: 0 auto 20px; display: block; }
        .section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .section:last-child { border-bottom: none; }
        .section-title { color: #0d6efd; font-size: 1.1rem; margin-bottom: 15px; border-bottom: 2px solid #0d6efd; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <div class="resume-container">
            <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
                {% csrf_token %}
                <!-- Header -->
                <div class="text-center mb-4">
                    <div class="position-relative d-inline-block">
                        <img src="{% static 'images/default-avatar.png' %}" class="profile-img" id="profile-preview">
                        <label class="position-absolute bottom-0 end-0 bg-primary text-white rounded-circle p-2" style="cursor:pointer;">
                            <i class="fas fa-camera"></i>
                            <input type="file" class="d-none" id="profile_image" name="profile_image" accept="image/*" onchange="previewImage(this)">
                        </label>
                    </div>
                    <input type="text" class="form-control form-control-lg text-center border-0 shadow-none fw-bold mt-2 mb-1"
                        name="full_name" placeholder="Your Full Name" value="{{ resume.full_name|default:'' }}" required>
                    <input type="text" class="form-control text-center border-0 shadow-none mb-2"
                        name="job_title" placeholder="Professional Title" value="{{ resume.job_title|default:'' }}">
                </div>

                <!-- Contact -->
                <div class="section">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <input type="email" class="form-control" name="email" placeholder="Email" value="{{ resume.email|default:'' }}" required>
                        </div>
                        <div class="col-md-6">
                            <input type="tel" class="form-control" name="phone" placeholder="Phone" value="{{ resume.phone|default:'' }}">
                        </div>
                        <div class="col-md-6">
                            <input type="text" class="form-control" name="location" placeholder="Location" value="{{ resume.location|default:'' }}">
                        </div>
                        <div class="col-md-6">
                            <input type="url" class="form-control" name="github" placeholder="GitHub" value="{{ resume.github|default:'' }}">
                        </div>
                    </div>
                </div>

                <!-- Summary -->
                <div class="section">
                    <textarea class="form-control" name="summary" rows="3" placeholder="Brief professional summary">{{ resume.summary|default:'' }}</textarea>
                </div>

                <!-- Skills -->
                <div class="section">
                    <input type="text" class="form-control mb-2" name="technical_skills" placeholder="Technical Skills (comma separated)" value="{{ resume.technical_skills|default:'' }}">
                    <input type="text" class="form-control mb-2" name="soft_skills" placeholder="Soft Skills (comma separated)" value="{{ resume.soft_skills|default:'' }}">
                    <input type="text" class="form-control" name="languages" placeholder="Languages (comma separated)" value="{{ resume.languages|default:'' }}">
                </div>

                <!-- Experience -->
                <div class="section">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span class="section-title"><i class="fas fa-briefcase me-1"></i>Experience</span>
                        <button type="button" class="btn btn-sm btn-outline-primary" id="add-experience"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="experience-container">
                        {% for exp in resume.experiences.all %}
                        <div class="row g-2 mb-2">
                            <div class="col-md-4"><input type="text" class="form-control mb-1" name="exp_title_{{ exp.id }}" placeholder="Job Title" value="{{ exp.job_title }}"></div>
                            <div class="col-md-4"><input type="text" class="form-control mb-1" name="exp_company_{{ exp.id }}" placeholder="Company" value="{{ exp.company }}"></div>
                            <div class="col-md-4"><input type="text" class="form-control mb-1" name="exp_duration_{{ exp.id }}" placeholder="Duration" value="{{ exp.duration }}"></div>
                            <div class="col-12"><textarea class="form-control" name="exp_description_{{ exp.id }}" rows="1" placeholder="Description">{{ exp.description }}</textarea></div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Education -->
                <div class="section">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span class="section-title"><i class="fas fa-graduation-cap me-1"></i>Education</span>
                        <button type="button" class="btn btn-sm btn-outline-primary" id="add-education"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="education-container">
                        {% for edu in resume.education_entries.all %}
                        <div class="row g-2 mb-2">
                            <div class="col-md-4"><input type="text" class="form-control mb-1" name="edu_degree_{{ edu.id }}" placeholder="Degree" value="{{ edu.degree }}"></div>
                            <div class="col-md-4"><input type="text" class="form-control mb-1" name="edu_institution_{{ edu.id }}" placeholder="Institution" value="{{ edu.institution }}"></div>
                            <div class="col-md-4"><input type="text" class="form-control mb-1" name="edu_year_{{ edu.id }}" placeholder="Year" value="{{ edu.year }}"></div>
                            <div class="col-12"><textarea class="form-control" name="edu_description_{{ edu.id }}" rows="1" placeholder="Description">{{ edu.description }}</textarea></div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Projects -->
                <div class="section">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span class="section-title"><i class="fas fa-project-diagram me-1"></i>Projects</span>
                        <button type="button" class="btn btn-sm btn-outline-primary" id="add-project"><i class="fas fa-plus"></i></button>
                    </div>
                    <div id="projects-container">
                        {% for proj in resume.projects.all %}
                        <div class="row g-2 mb-2">
                            <div class="col-md-5"><input type="text" class="form-control mb-1" name="project_title_{{ proj.id }}" placeholder="Project Title" value="{{ proj.title }}"></div>
                            <div class="col-md-5"><input type="text" class="form-control mb-1" name="project_tech_{{ proj.id }}" placeholder="Technologies Used" value="{{ proj.tech_stack }}"></div>
                            <div class="col-md-2"><input type="url" class="form-control mb-1" name="project_url_{{ proj.id }}" placeholder="URL" value="{{ proj.live_url }}"></div>
                            <div class="col-12"><textarea class="form-control" name="project_description_{{ proj.id }}" rows="1" placeholder="Description">{{ proj.description }}</textarea></div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Submit -->
                <div class="text-center mt-4">
                    <button type="submit" class="btn btn-primary btn-lg"><i class="fas fa-save me-2"></i>Save Resume</button>
                    <button type="button" class="btn btn-outline-secondary btn-lg ms-2" id="preview-btn"><i class="fas fa-eye me-2"></i>Preview</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profile-preview').src = e.target.result;
                }
                reader.readAsDataURL(input.files);
            }
        }
        document.getElementById('add-experience')?.addEventListener('click', function() {
            const c = document.getElementById('experience-container');
            const i = c.children.length;
            c.insertAdjacentHTML('beforeend',
                `<div class="row g-2 mb-2">
                    <div class="col-md-4"><input type="text" class="form-control mb-1" name="new_exp_title_${i}" placeholder="Job Title"></div>
                    <div class="col-md-4"><input type="text" class="form-control mb-1" name="new_exp_company_${i}" placeholder="Company"></div>
                    <div class="col-md-4"><input type="text" class="form-control mb-1" name="new_exp_duration_${i}" placeholder="Duration"></div>
                    <div class="col-12"><textarea class="form-control" name="new_exp_description_${i}" rows="1" placeholder="Description"></textarea></div>
                </div>`);
        });
        document.getElementById('add-education')?.addEventListener('click', function() {
            const c = document.getElementById('education-container');
            const i = c.children.length;
            c.insertAdjacentHTML('beforeend',
                `<div class="row g-2 mb-2">
                    <div class="col-md-4"><input type="text" class="form-control mb-1" name="new_edu_degree_${i}" placeholder="Degree"></div>
                    <div class="col-md-4"><input type="text" class="form-control mb-1" name="new_edu_institution_${i}" placeholder="Institution"></div>
                    <div class="col-md-4"><input type="text" class="form-control mb-1" name="new_edu_year_${i}" placeholder="Year"></div>
                    <div class="col-12"><textarea class="form-control" name="new_edu_description_${i}" rows="1" placeholder="Description"></textarea></div>
                </div>`);
        });
        document.getElementById('add-project')?.addEventListener('click', function() {
            const c = document.getElementById('projects-container');
            const i = c.children.length;
            c.insertAdjacentHTML('beforeend',
                `<div class="row g-2 mb-2">
                    <div class="col-md-5"><input type="text" class="form-control mb-1" name="new_project_title_${i}" placeholder="Project Title"></div>
                    <div class="col-md-5"><input type="text" class="form-control mb-1" name="new_project_tech_${i}" placeholder="Technologies Used"></div>
                    <div class="col-md-2"><input type="url" class="form-control mb-1" name="new_project_url_${i}" placeholder="URL"></div>
                    <div class="col-12"><textarea class="form-control" name="new_project_description_${i}" rows="1" placeholder="Description"></textarea></div>
                </div>`);
        });
        document.getElementById('preview-btn')?.addEventListener('click', function() {
            alert('Preview functionality coming soon');
        });
        // Form validation (Bootstrap style)
        (function() {
            'use strict';
            const forms = document.querySelectorAll('.needs-validation');
            Array.from(forms).forEach(function(form) {
                form.addEventListener('submit', function(event) {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        })();
    </script>
</body>
</html>
