{% extends 'base.html' %}

{% block title %}StudyShala - Your Learning Platform{% endblock %}

{% block content %}
<div class="container text-center" style="margin-top: 60px;">
  
  <h1 class="mb-4">Welcome to StudyShala</h1>
  <div class="d-flex justify-content-center gap-3 flex-wrap">
    <a href="{% url 'scanner:scan_note' %}" class="btn btn-primary btn-lg" style="padding: 15px 40px; font-size: 1.5rem; border-radius: 8px;">
      üìÑ Scan Notes (OCR to PDF)
    </a>
    {% if user.is_authenticated %}
      <a href="{% url 'resume:builder' %}" class="btn btn-success btn-lg" style="padding: 15px 40px; font-size: 1.5rem; border-radius: 8px;">
        üìù Resume Builder
      </a>
    {% else %}
      <a href="{% url 'accounts:login' %}?next={% url 'resume:builder' %}" class="btn btn-outline-success btn-lg" style="padding: 15px 40px; font-size: 1.5rem; border-radius: 8px;">
        üîí Login for Resume Builder
      </a>
    {% endif %}
  </div>
</div>

<!-- Employee ID Card Preview Section -->
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card shadow" style="border-radius: 16px; overflow: hidden;">
        <div class="card-header bg-dark text-white text-center" style="padding: 10px 0;">
          <h4 class="mb-0" style="letter-spacing: 1px;">Employee ID Card</h4>
        </div>
        <div class="card-body" style="background: #f8fafc;">
          {% if employee %}
          <div class="row g-2 align-items-center">
            <div class="col-4 text-center">
              {% if employee.profile_image %}
                <img src="{{ employee.profile_image.url }}" alt="{{ employee.full_name|default:'Employee' }}'s profile" class="img-fluid rounded border mb-2" style="max-height: 90px; object-fit: cover;">
              {% else %}
                <div class="bg-light rounded p-3 text-center">
                  <i class="fas fa-user fa-2x text-secondary"></i>
                </div>
              {% endif %}
              {% if employee.qr_code %}
                <img src="{{ employee.qr_code.url }}" alt="QR Code" class="img-fluid mt-2" style="max-width: 60px;">
              {% endif %}
            </div>
            <div class="col-8">
              <table class="table table-sm table-bordered mb-0" style="font-size: 13px;">
                <tr><th>Name</th><td>{{ employee.full_name }}</td></tr>
                <tr><th>ID</th><td>{{ employee.employee_id }}</td></tr>
                <tr><th>Designation</th><td>{{ employee.designation }}</td></tr>
                <tr><th>Department</th><td>{{ employee.department }}</td></tr>
                <tr><th>Company</th><td>{{ employee.company }}</td></tr>
              </table>
              <div class="mt-2 text-end">

                <a href="{% url 'employeeid:employee_card' employee.pk %}" class="btn btn-outline-primary btn-sm me-2">View Full Card</a>
                <a href="{% url 'employeeid:update_employee' employee.pk %}" class="btn btn-outline-warning btn-sm">Update</a>
              </div>
            </div>
          </div>
          {% else %}
            <div class="text-center">

              <a href="{% url 'employeeid:upload_employee' %}" class="btn btn-primary">Create Employee Card</a>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Notes Section -->
<div class="container mt-5">
  <h2 class="text-center mb-4">Recent Notes</h2>
  {% if recent_notes %}
    <div class="row justify-content-center">
      {% for note in recent_notes %}
        <div class="col-md-4 mb-4">
          <div class="card feature-card h-100 shadow-sm">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ note.title|default:'Untitled Note' }}</h5>
              <p class="card-text flex-grow-1">
                {% if note.description %}
                  {{ note.description|truncatewords:20 }}
                {% else %}
                  <span class="text-muted">No description available</span>
                {% endif %}
              </p>
              <div class="mt-auto">
                <a href="{% url 'notes:note_detail' note.id %}" class="btn btn-outline-primary w-100">View Note</a>
              </div>
            </div>
            <div class="card-footer bg-transparent">
              <small class="text-muted">
                {{ note.uploaded_by.get_full_name|default:note.uploaded_by.username }} ‚Ä¢ {{ note.uploaded_at|timesince }} ago
              </small>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
    <div class="text-center mt-3">

<a href="{% url 'notes:notes_list' %}" class="btn btn-outline-secondary">View All Notes</a>es</a>
    </div>
  {% else %}
    <div class="alert alert-info text-center">
      No notes available yet. 
      {% if user.is_authenticated %}
        <a href="{% url 'notes:upload_note' %}" class="alert-link">Upload the first note!</a>
      {% else %}
        <a href="{% url 'accounts:login' %}?next={% url 'notes:upload_note' %}" class="alert-link">Login to upload notes</a>
      {% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}